function dydt = RK_perso9(param,t,y,Tmax,Pcore,DeltaP,DeltaP2)
    dydt=zeros(9,1);
    Ta=Tmax*param.profil(t)+273;
    tau=y(1,:);
    w=y(2,:);
    R2w=y(3,:);
    r2w=y(4,:);
    T=y(5,:);
    Rc2w1=y(6,:);
    rc2w1=y(7,:);
    Rc2w2=y(8,:);
    rc2w2=y(9,:);
    R=sqrt(R2w./w);
    r=sqrt(r2w./w);
    mu=param.viscosity(T);
    mu_1=param.viscosity_1(T);
    mu_2=param.viscosity_2(T);
    dwdz=tau/(3*pi*mu*(R^2-r^2));
    Rc1=sqrt(Rc2w1./w);
    rc1=sqrt(rc2w1./w);
    Rc2=sqrt(Rc2w2./w);
    rc2=sqrt(rc2w2./w);
    dydt(3)=(Pcore*r^2*R^2-param.gamma(T)*r*R*(r+R))/(mu*(R^2-r^2));
    dydt(1)=param.rho(T)*pi*(R^2-r^2)*(w*dwdz-param.g)-param.gamma(T)*pi*(dydt(3)-R^2*dwdz)/(2*R*w)-param.gamma(T)*pi*(dydt(3)-r^2*dwdz)/(2*r*w);
    dydt(2)=dwdz;
    dydt(4)=dydt(3);
    %dydt(5)=(R*param.N*(Ta-T)*2/(R^2-r^2)+param.sigma*param.alpha(T)*(Ta^4-T^4))/(param.rho(T)*param.Cp(T)*w);
    dydt(5)=(R*param.N*(Ta-T)+R*param.sigma*(param.alpha(Ta)*Ta^4-param.alpha(T)*T^4))*2/(R^2-r^2)/(param.rho(T)*param.Cp(T)*w);
    dydt(6)=(DeltaP*rc1^2*Rc1^2-param.gamma_1(T)*rc1*Rc1*(rc1+Rc1))/(mu_1*(Rc1^2-rc1^2));         
    dydt(7)=dydt(6);
    dydt(8)=(DeltaP2*rc2^2*Rc2^2-param.gamma_2(T)*rc2*Rc2*(rc2+Rc2))/(mu_2*(Rc2^2-rc2^2));         
    dydt(9)=dydt(8);
end

